/**
 * @license knockout-arraytransforms 1.0.0 (https://github.com/mwiencek/knockout-arraytransforms)
 * Released under the X11 License; see the LICENSE file in the official code repository.
 */
!function(e){"undefined"!=typeof module&&void 0!==module.exports?module.exports=e(require("knockout")):"function"==typeof define&&define.amd?define(["knockout"],e):e(window.ko)}(function(e){"use strict";function t(){}function i(e,t){return e===t}function a(e,t){return e!==t}function s(i,a){function s(){}return s.prototype=new t,e.utils.extend(s.prototype,a),e.observableArray.fn[i]=function(e,t){var i=new s;i.init(this,e,t);var a=this.peek();return this.subscribe(i.applyChanges,i,"arrayChange"),i.applyChanges(a.map(function(e,t){return{status:"added",value:e,index:t}})),i.state},s}function r(e,t,i){this.init(e),this.groupKey=t,this.mappedItems=i,this.mappedIndexProp="mappedIndex."+t}var n=1;t.prototype.init=function(t,i,a){this.mappedItems=[],this.original=t,this.callback=i,this.state=this.getInitialState(a);var s=this.state;e.isObservable(s)&&s.cacheDiffForKnownOperation&&(e.version>="3.3.0"?(s.beforeSubscriptionAdd=e.observableArray.fn.beforeSubscriptionAdd,s.afterSubscriptionRemove=e.observableArray.fn.afterSubscriptionRemove):s.subscribe=e.observableArray.fn.subscribe,this.previousState=this.state.peek().concat())},t.prototype.applyChanges=function(t){var i=this,s=this.mappedItems,r=Object.create(null),n=0,o=0;t.forEach(function(t){if("retained"!==t.status){var u,p=t.index,d=void 0!==t.moved,l=null;n=Math.min(n,p),"added"===t.status?(u=t.moved+o,d?(l=r[p],l||(l=r[p]=s[u],s[u]=null)):(l=Object.create(null),l.index=e.observable(p),l.index.isDifferent=a,l.value=t.value,i.mapValue(l)),s.splice(p,0,l),i.valueAdded(t.value,p,l.mappedValue,l,d),o++):"deleted"===t.status&&(u=p+o,d?l=r[t.moved]||(r[t.moved]=s[u]):(l=s[u],l.computed&&l.computed.dispose()),s.splice(u,1),i.valueDeleted(t.value,u,l.mappedValue,l,d),o--)}});for(var u=n,p=s.length;p>u;u++)s[u].index(u);this.notifyChanges()},t.prototype.notifyChanges=function(){var t=this.state.peek();if(t){var i=e.utils.compareArrays(this.previousState,t,{sparse:!0});if(i.length){this.previousState=t.concat();var a=this.original,s=a.notifySubscribers,r=a.peek().concat(),n=!1;a.notifySubscribers=function(e,t){"arrayChange"===t?n=!0:s.apply(a,arguments)},this.state.notifySubscribers(t),this.state.notifySubscribers(i,"arrayChange"),a.notifySubscribers=s,n&&(i=e.utils.compareArrays(r,a.peek(),{sparse:!0}),i.length&&a.notifySubscribers(i,"arrayChange"))}}},t.prototype.mapValue=function(t){var a=this.callback;if(void 0===a)return void(t.mappedValue=t.value);var s=this,r="callback";if("function"!=typeof a){if(s=t.value,r=a,a=s[r],"function"!=typeof a)return void(t.mappedValue=a);if(e.isObservable(a))return void this.watchItem(t,a)}var n=e.computed(function(){return s[r](t.value,t.index)});return n.isActive()?(n.equalityComparer=i,this.watchItem(t,n),t.computed=n,n):void(t.mappedValue=n.peek())},t.prototype.watchItem=function(e,t){var i=this;e.mappedValue=t.peek(),t.subscribe(function(t){i.valueMutated(e.value,t,e.mappedValue,e),e.mappedValue=t,i.notifyChanges()})},s("sortBy",{getInitialState:function(){return this.keyCounts=Object.create(null),this.sortedItems=[],e.observableArray([])},valueAdded:function(e,t,i,a,s){var r=this.sortedIndexOf(i,e,a),o=this.sortedItems;if(s){var u=o.indexOf(a);u>=0&&(a.previousMappedIndex=u)}var p=this.keyCounts;o.splice(r,0,a),p[i]=(p[i]||0)+1,this.state.peek().splice(r,0,e);for(var d=n++,l=r,f=o.length;f>l;l++)a=o[l],a.seen!==d&&void 0!==a.previousMappedIndex&&a.previousMappedIndex>=r&&++a.previousMappedIndex,a.seen=d},valueDeleted:function(e,t,i,a,s){var r,o=this.sortedItems;s&&void 0!==a.previousMappedIndex?(r=a.previousMappedIndex,delete a.previousMappedIndex):r=o.indexOf(a),o.splice(r,1),this.keyCounts[i]--,this.state.peek().splice(r,1);for(var u=n++,p=r,d=o.length;d>p;p++)a=o[p],a.seen!==u&&void 0!==a.previousMappedIndex&&a.previousMappedIndex>r&&--a.previousMappedIndex,a.seen=u},valueMutated:function(e,t,i,a){var s=this.keyCounts,r=this.sortedItems.indexOf(a),n=this.sortedIndexOf(t,e,a);if(s[i]--,s[t]=(s[t]||0)+1,n>r&&n--,r!==n){var o=this.state.peek(),u=this.sortedItems;u.splice(r,1),u.splice(n,0,a),o.splice(r,1),o.splice(n,0,e)}},sortedIndexOf:function(e,t,i){var a=this.sortedItems,s=a.length;if(!s)return 0;for(var r,n=0,o=s-1;o>=n;)if(r=n+o>>1,e>a[r].mappedValue)n=r+1;else if((o=r)===n)break;var u=this.keyCounts[e],p=0;if(u)for(var d,l=this.mappedItems,f=0;s>f;f++)if(d=l[f]){if(d===i)break;if(d.mappedValue===e&&p++,p===u)break}return n+p}});var o={mappedIndexProp:"mappedIndex",getInitialState:function(){return e.observableArray([])},filteredIndexOf:function(e,t,i){var a,s=0;return i>0&&(a=e[i-1],s=a[t]||0,this.getVisibility(a.mappedValue)&&s++),s},valueAdded:function(e,t,i,a){i=this.getVisibility(i);var s=this.mappedItems,r=this.mappedIndexProp;if(i)for(var n,o=t+1,u=s.length;u>o;o++)n=s[o],n&&n[r]++;var p=this.filteredIndexOf(s,r,t);i&&this.state.peek().splice(p,0,e),a[r]=p},valueDeleted:function(e,t,i,a){if(this.getVisibility(i)){var s=this.mappedItems,r=this.mappedIndexProp,n=this.filteredIndexOf(s,r,t);s[t]===a&&t++;for(var o,u=t,p=s.length;p>u;u++)o=s[u],o&&o[r]--;this.state.peek().splice(n,1)}},valueMutated:function(e,t,i,a){var s=this.mappedItems.indexOf(a);this.valueAdded(e,s,t,a),this.valueDeleted(e,s,i,a)}},u=s("filter",e.utils.extend({getVisibility:Boolean},o));s("reject",e.utils.extend({getVisibility:function(e){return!e}},o)),r.prototype=new u,r.prototype.getVisibility=function(e){return e+""===this.groupKey},s("groupBy",{getInitialState:function(){return this.groups=Object.create(null),e.observableArray([])},applyChanges:function(e){var i,a=this.groups,s=!1;t.prototype.applyChanges.call(this,e);for(i in a)a[i].notifyChanges(),a[i].state.peek().length||(this.deleteGroup(i),s=!0);s&&this.notifyChanges()},valueAdded:function(e,t,i,a){i+="";var s,n=this.groups;if(!n[i]){var o=new r(this.original,i,this.mappedItems);n[i]=o;var u=Object.create(null);u.key=i,u.values=o.state,this.state.peek().push(u)}for(s in n)n[s].valueAdded(e,t,i,a)},valueDeleted:function(e,t,i,a){var s,r=this.groups;for(s in r)r[s].valueDeleted(e,t,i,a)},valueMutated:function(e,t,i,a){var s,r,n=this.groups,o=this.mappedItems.indexOf(a);this.valueDeleted(e,o,i,a),this.valueAdded(e,o,t,a);for(r in n)s=n[r],s.notifyChanges(),s.state.peek().length||this.deleteGroup(r)},deleteGroup:function(e){var t=this.state.peek();delete this.groups[e];for(var i=0,a=t.length;a>i;i++)if(t[i].key===e)return t.splice(i,1)}}),s("map",{getInitialState:function(){return e.observableArray([])},valueAdded:function(e,t,i){this.state.peek().splice(t,0,i)},valueDeleted:function(e,t){this.state.peek().splice(t,1)},valueMutated:function(e,t,i,a){this.state.peek()[this.mappedItems.indexOf(a)]=t}});var p={getInitialState:function(){return this.truthinessCount=0,e.observable(this.getTruthiness())},valueAdded:function(e,t,i){this.valueMutated(null,i,!1)},valueDeleted:function(e,t,i){this.valueMutated(null,!1,i)},valueMutated:function(e,t,i){t&&!i?this.truthinessCount++:i&&!t&&this.truthinessCount--,this.state(this.getTruthiness())}};return s("any",e.utils.extend({getTruthiness:function(){return this.truthinessCount>0}},p)),s("all",e.utils.extend({getTruthiness:function(){return this.truthinessCount===this.mappedItems.length}},p)),e.observableArray.fn.some=e.observableArray.fn.any,e.observableArray.fn.every=e.observableArray.fn.all,e.arraytransforms={createTransform:s},e.arrayTransforms=e.arraytransforms,e.arrayTransforms.makeTransform=e.arraytransforms.createTransform,e.arraytransforms});